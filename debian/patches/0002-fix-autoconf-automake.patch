From: YunQiang Su <wzssyqa@gmail.com>
Date: Mon, 28 May 2012 18:28:28 +0800
Subject: fix autoconf automake

---
 config.h.in        |    3 +++
 configure.in       |   13 ++++++-------
 doc/Makefile.am    |    2 +-
 python/Makefile.am |   19 ++++++++++---------
 4 files changed, 20 insertions(+), 17 deletions(-)

diff --git a/config.h.in b/config.h.in
index b3e2dd5..b33c9e6 100644
--- a/config.h.in
+++ b/config.h.in
@@ -157,6 +157,9 @@
 /* Define to the one symbol short name of this package. */
 #undef PACKAGE_TARNAME
 
+/* Define to the home page for this package. */
+#undef PACKAGE_URL
+
 /* Define to the version of this package. */
 #undef PACKAGE_VERSION
 
diff --git a/configure.in b/configure.in
index 756003d..36f0ebb 100644
--- a/configure.in
+++ b/configure.in
@@ -84,7 +84,7 @@ VERSION=${LIBXSLT_VERSION}
 
 AM_INIT_AUTOMAKE($PACKAGE, $VERSION)
 
-# AM_MAINTAINER_MODE
+AM_MAINTAINER_MODE
 
 dnl
 dnl Specific dir for HTML output ?
@@ -448,6 +448,7 @@ else
     WITH_DEBUGGER=1
     AC_DEFINE(WITH_DEBUGGER)
 fi
+AM_CONDITIONAL(WITH_DEBUGGER, test "${WITH_DEBUGGER}" = "1")
 AC_SUBST(WITH_DEBUGGER)
 
 dnl
@@ -650,14 +651,14 @@ AC_SUBST(PYTHON_SITE_PACKAGES)
 
 XSLT_LIBDIR='-L${libdir}'
 XSLT_INCLUDEDIR='-I${includedir}'
-XSLT_LIBS="-lxslt $LIBXML_LIBS $M_LIBS"
+XSLT_LIBS="-lxslt $LIBXML_LIBS"
 AC_SUBST(XSLT_LIBDIR)
 AC_SUBST(XSLT_INCLUDEDIR)
 AC_SUBST(XSLT_LIBS)
 
 EXSLT_LIBDIR='-L${libdir}'
 EXSLT_INCLUDEDIR='-I${includedir}'
-EXSLT_LIBS="-lexslt $XSLT_LIBS $LIBGCRYPT_LIBS"
+EXSLT_LIBS="-lexslt $XSLT_LIBS"
 AC_SUBST(EXSLT_LIBDIR)
 AC_SUBST(EXSLT_INCLUDEDIR)
 AC_SUBST(EXSLT_LIBS)
@@ -671,10 +672,8 @@ dnl for the spec file
 RELDATE=`date +'%a %b %e %Y'`
 AC_SUBST(RELDATE)
 
-( cd $srcdir
-rm -f COPYING.LIB COPYING
-$LN_S Copyright COPYING
-)
+#rm -f COPYING.LIB COPYING
+#ln -s Copyright COPYING
 
 
 AC_OUTPUT([
diff --git a/doc/Makefile.am b/doc/Makefile.am
index d8aaf2b..24e4edb 100644
--- a/doc/Makefile.am
+++ b/doc/Makefile.am
@@ -45,7 +45,7 @@ EXTRA_DIST =			\
 
 man_MANS = xsltproc.1
 
-all:	web ../NEWS libxslt.xsa $(man_MANS)
+all:	$(man_MANS)
 
 api:	libxslt-api.xml libxslt-refs.xml $(APIPAGES) search.php \
         html/index.html $(WIN32_DIR)/libxslt.def.src
diff --git a/python/Makefile.am b/python/Makefile.am
index 9591c11..118b6f2 100644
--- a/python/Makefile.am
+++ b/python/Makefile.am
@@ -35,11 +35,12 @@ all-local: libxslt.py
 
 python_LTLIBRARIES = libxsltmod.la
 
-libxsltmod_la_SOURCES = libxslt.c types.c libxslt-py.c
+libxsltmod_la_SOURCES = $(srcdir)/libxslt.c $(srcdir)/types.c
+nodist_libxsltmod_la_SOURCES = libxslt-py.c
 libxsltmod_la_LIBADD = $(mylibs) 
 
-libxslt.py: $(srcdir)/libxsl.py $(srcdir)/libxsltclass.py
-	cat $(srcdir)/libxsl.py $(srcdir)/libxsltclass.py > libxslt.py
+libxslt.py: $(srcdir)/libxsl.py libxsltclass.py
+	cat $(srcdir)/libxsl.py libxsltclass.py > libxslt.py
 
 install-data-local:
 	$(mkinstalldirs) $(DESTDIR)$(pythondir)
@@ -50,16 +51,16 @@ install-data-local:
 
 GENERATE = generator.py
 API_DESC = $(top_srcdir)/doc/libxslt-api.xml $(srcdir)/libxslt-python-api.xml
-GENERATED= $(srcdir)/libxsltclass.py \
-           $(srcdir)/libxslt-export.c \
-	   $(srcdir)/libxslt-py.c \
-	   $(srcdir)/libxslt-py.h \
-	   $(srcdir)/libxsltclass.txt
+GENERATED= libxsltclass.py \
+           libxslt-export.c \
+           libxslt-py.c \
+           libxslt-py.h \
+           libxsltclass.txt
 
 $(GENERATED): gen_prog
 
 gen_prog:  $(srcdir)/$(GENERATE) $(API_DESC)
-	cd $(srcdir) && $(PYTHON) $(GENERATE)
+	$(PYTHON) $(srcdir)/$(GENERATE) $(srcdir)
 	touch gen_prog
 
 $(libxsltmod_la_OBJECTS): $(GENERATED)
-- 
