From: Markus Koschany <apo@debian.org>
Date: Sun, 27 Oct 2019 14:41:11 +0100
Subject: CVE-2019-18197

Bugs-Debian: https://bugs.debian.org/942646
Origin: https://gitlab.gnome.org/GNOME/libxslt/commit/2232473733b7313d67de8836ea3b29eec6e8e285
---
 libxslt/transform.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/libxslt/transform.c b/libxslt/transform.c
index 3d6a16b..b4aeb68 100644
--- a/libxslt/transform.c
+++ b/libxslt/transform.c
@@ -993,6 +993,8 @@ xsltCopyText(xsltTransformContextPtr ctxt, xmlNodePtr target,
 	    if ((copy->content = xmlStrdup(cur->content)) == NULL)
 		return NULL;
 	}
+
+	ctxt->lasttext = NULL;
     } else {
         /*
 	 * normal processing. keep counters to extend the text node
